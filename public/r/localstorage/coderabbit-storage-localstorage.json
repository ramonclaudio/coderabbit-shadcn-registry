{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "coderabbit-storage-localstorage",
  "type": "registry:lib",
  "title": "CodeRabbit LocalStorage Adapter",
  "description": "Browser localStorage adapter for client-side report persistence. Perfect for testing, prototyping, and browser-based applications. Reports persist across page reloads.",
  "registryDependencies": [
    "coderabbit-types",
    "coderabbit-storage-adapter"
  ],
  "files": [
    {
      "path": "registry/default/coderabbit/lib/storage-localstorage.ts",
      "content": "/**\n * LocalStorage Storage Adapter\n * Perfect for browser-based apps and client-side persistence\n */\n\nimport type { ReportStorageAdapter } from '@/registry/default/coderabbit/lib/storage-adapter'\nimport type {\n  StoredReport,\n  ReportResult,\n} from '@/registry/default/coderabbit/lib/types'\n\n/**\n * LocalStorage storage adapter\n * Persists reports in browser localStorage\n * Perfect for client-side apps and testing\n */\nexport class LocalStorageAdapter implements ReportStorageAdapter {\n  private key: string\n\n  constructor(key = 'coderabbit:reports') {\n    this.key = key\n\n    // Check if localStorage is available\n    if (typeof window === 'undefined' || !window.localStorage) {\n      throw new Error('localStorage is not available in this environment')\n    }\n  }\n\n  private getReports(): StoredReport[] {\n    const data = localStorage.getItem(this.key)\n    return data ? JSON.parse(data) : []\n  }\n\n  private saveReports(reports: StoredReport[]): void {\n    localStorage.setItem(this.key, JSON.stringify(reports))\n  }\n\n  async create(\n    data: Omit<StoredReport, 'id' | 'results' | 'status' | 'createdAt'>,\n  ): Promise<string> {\n    const reports = this.getReports()\n    const id = `report_${Date.now()}_${Math.random().toString(36).slice(2, 9)}`\n\n    const report: StoredReport = {\n      ...data,\n      id,\n      results: [],\n      status: 'pending',\n      createdAt: Date.now(),\n    }\n\n    reports.push(report)\n    this.saveReports(reports)\n    return id\n  }\n\n  async updateSuccess(\n    id: string,\n    results: ReportResult[],\n    durationMs: number,\n  ): Promise<void> {\n    const reports = this.getReports()\n    const report = reports.find((r) => r.id === id)\n    if (!report) throw new Error(`Report not found: ${id}`)\n\n    report.results = results\n    report.status = 'completed'\n    report.durationMs = durationMs\n    this.saveReports(reports)\n  }\n\n  async updateFailure(\n    id: string,\n    error: string,\n    durationMs: number,\n  ): Promise<void> {\n    const reports = this.getReports()\n    const report = reports.find((r) => r.id === id)\n    if (!report) throw new Error(`Report not found: ${id}`)\n\n    report.status = 'failed'\n    report.error = error\n    report.durationMs = durationMs\n    this.saveReports(reports)\n  }\n\n  async get(id: string): Promise<StoredReport | null> {\n    const reports = this.getReports()\n    return reports.find((r) => r.id === id) ?? null\n  }\n\n  async list(options?: {\n    limit?: number\n    offset?: number\n  }): Promise<StoredReport[]> {\n    const reports = this.getReports()\n    const sorted = reports.sort((a, b) => b.createdAt - a.createdAt)\n\n    if (options) {\n      const start = options.offset ?? 0\n      const end = start + (options.limit ?? reports.length)\n      return sorted.slice(start, end)\n    }\n\n    return sorted\n  }\n\n  async delete(id: string): Promise<void> {\n    const reports = this.getReports()\n    this.saveReports(reports.filter((r) => r.id !== id))\n  }\n\n  /**\n   * Clear all reports (useful for testing)\n   */\n  clear(): void {\n    localStorage.removeItem(this.key)\n  }\n}\n",
      "type": "registry:lib"
    }
  ],
  "categories": [
    "storage",
    "browser"
  ]
}